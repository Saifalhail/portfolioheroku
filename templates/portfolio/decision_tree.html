{% load static %}
<div id="ajax-page" class="ajax-page-content">
    <div class="ajax-page-wrapper">
        <div class="ajax-page-nav">
            <div class="nav-item ajax-page-prev-next">
                <a class="ajax-page-load" href="{% static 'portfolio-3.html' %}"><i
                        class="lnr lnr-chevron-left"></i></a>
                <a class="ajax-page-load" href="{% static 'portfolio-2.html' %}"><i
                        class="lnr lnr-chevron-right"></i></a>
            </div>
            <div class="nav-item ajax-page-close-button">
                <a id="ajax-page-close-button" href="#"><i class="lnr lnr-cross"></i></a>
            </div>
        </div>

        <div class="ajax-page-title">
            <h1>Decision Tree Algorithm</h1>
        </div>

        <div class="row">

            <div class="col-sm-8 col-md-8 portfolio-block">
                <!-- <div class="owl-carousel portfolio-page-carousel"> -->
                <div class="item">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis architecto ut corporis
                        asperiores totam quibusdam dolor illum, nam quos doloribus. Quae nostrum minus similique
                        temporibus impedit iure ducimus possimus ea?</p>
                </div>
                <div class="item">
                    <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Impedit asperiores facere, quia
                        consequatur vitae nobis inventore eaque recusandae qui dolorum sunt aperiam autem minus
                        reiciendis! Neque corrupti cupiditate alias voluptates.</p>
                </div>
                <div class="item">
                    <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Assumenda omnis asperiores aliquid
                        itaque, corporis, corrupti maiores ullam optio odit magnam id fuga vitae voluptatibus ducimus
                        officiis incidunt odio, eaque sunt?</p>
                    <!-- <ul>
                        {% for i in test3 %}
                        <li>{{i}}</li>
                        {% endfor %}
                    </ul> -->
                    
                    <button type="button" id="" style="cursor:pointer">RUN</button>
                    <!-- <div class="row">
                        <div class="col-md-4 offset-md-8" style="padding-bottom: 4px">
                            <select id="csvFilesFilter" class="form-control">
                                {% for file in pickle_files %}
                                <option>{{file}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                     -->
                    <div id="lineChart" class="d-none" style="background-color: #FFF; padding: 10px; border-radius: 8px;">
                        <div class="preloader-spinner d-none"></div>
                        
                        <table id="dataTable" ></table>
                    </div>
                    
                    <!-- <img src="{% static 'img/results/result.png' %}" alt="Result not yet" /> -->

                </div>

                <!-- </div> -->

                <!-- <div class="portfolio-page-video embed-responsive embed-responsive-16by9">
                  <iframe class="embed-responsive-item" src="https://player.vimeo.com/video/97102654?autoplay=0"></iframe>
                </div> -->

                
                <script type="text/javascript">
                    var myChart = false
                    jQuery(document).ready(function ($) {
                        $('.portfolio-page-carousel').imagesLoaded(function () {
                            $('.portfolio-page-carousel').owlCarousel({
                                smartSpeed: 1200,
                                items: 1,
                                loop: true,
                                dots: true,
                                nav: true,
                                navText: false,
                                margin: 10,
                                autoHeight: true
                            });
                        });

                        $('#runBtn').click(function(){
                            renderChart()
                        })
                    });

                    function renderChart(){
                        $('#runBtn').attr('disabled','disabled');
                        if ( $.fn.dataTable.isDataTable( '#dataTable' ) ) {
                            $('#dataTable').DataTable().destroy();
                            $('#dataTable').empty();
                        }
                        // Show loader for chart area
                        $('#lineChart').removeClass('d-none')
                        $('.preloader-spinner').removeClass('d-none')
                        let csvFile = $( "#csvFilesFilter option:selected" ).text();

                        $.post("{% url 'decision_tree' %}", {pickle:csvFile})
                        .done( function(response){
                            $('#runBtn').removeAttr('disabled');
                            console.log(response)
                            let columns = []
                            response.result.columns.forEach((col)=> {
                                columns.push({'title': col})
                            })
                            console.log(columns)
                            // Hide the loader into Chart area
                            $('.preloader-spinner').addClass('d-none')
                            $('#dataTable').DataTable( {
                                searching: false,
                                ordering:  false,
                                scrollX: true,
                                columns: columns,
                                data: response.result.data
                            } );
                        })
                        .fail( function(xhr, textStatus, errorThrown) {
                            $('#runBtn').removeAttr('disabled');
                            console.log(textStatus, errorThrown)
                            alert(xhr.responseText);
                        });
                    }
                </script>
            </div>

            <div class="col-sm-4 col-md-4 portfolio-block">
                <!-- Project Description -->
                <div class="project-description">
                    <div class="block-title">
                        <h3>Description</h3>
                    </div>
                    <ul class="project-general-info">
                        <li>
                            <p><i class="fa fa-user"></i> Saif Alhail</p>
                        </li>
                        <li>
                            <p><i class="fa fa-globe"></i> <a href="#" target="_blank">www.project-site.com</a></p>
                        </li>
                        <li>
                            <p><i class="fa fa-calendar"></i> 25 december, 2016</p>
                        </li>
                    </ul>

                    <p class="text-justify">Aliquam euismod aliquam massa, quis eleifend dui sodales vitae. Interdum et
                        malesuada fames ac ante ipsum primis in faucibus.</p>
                    <!-- /Project Description -->

                    <!-- Technology -->
                    <div class="tags-block">
                        <div class="block-title">
                            <h3>Technology</h3>
                        </div>
                        <ul class="tags">
                            <li><a>HTML5</a></li>
                            <li><a>CSS3</a></li>
                            <li><a>jQuery</a></li>
                            <li><a>Ajax</a></li>
                            <li><a>PHP5</a></li>
                        </ul>
                    </div>
                    <!-- /Technology -->

                    <!-- Share Buttons -->
                    <div class="btn-group share-buttons">
                        <div class="block-title">
                            <h3>Share</h3>
                        </div>
                        <a href="#" target="_blank" class="btn"><i class="fab fa-facebook-f"></i> </a>
                        <a href="#" target="_blank" class="btn"><i class="fab fa-twitter"></i> </a>
                        <a href="#" target="_blank" class="btn"><i class="fab fa-dribbble"></i> </a>
                    </div>
                    <!-- /Share Buttons -->
                </div>
                <!-- Project Description -->
            </div>
        </div>
    </div>
</div>