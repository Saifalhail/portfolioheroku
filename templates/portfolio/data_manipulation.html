{% load static %}
<div id="ajax-page" class="ajax-page-content">
  <div class="ajax-page-wrapper">
    <div class="ajax-page-nav">
      <div class="nav-item ajax-page-prev-next">
        <a class="ajax-page-load" href="{% url 'lstm_algorithm' %}"
          ><i class="lnr lnr-chevron-left"></i
        ></a>
        <a class="ajax-page-load" href="{% url 'web_scraping' %}"
          ><i class="lnr lnr-chevron-right"></i
        ></a>
      </div>
      <div class="nav-item ajax-page-close-button">
        <a id="ajax-page-close-button" href="#"
          ><i class="lnr lnr-cross"></i
        ></a>
      </div>
    </div>

    <div class="ajax-page-title">
      <h1>Data Manipulation and Handling</h1>
    </div>

    <div class="row">
      <div class="col-sm-8 col-md-8 portfolio-block">
        <!-- <div class="owl-carousel portfolio-page-carousel"> -->
        <div class="item">
          <p>
            The objective of this program is to use a massive amount of data
            stored in pickles format (Bytes), extract that information then, and
            then manipulate this data. First, cleaning the data and transforming
            all data into one type, such as removing decimals, extra 0's, and
            combining all data in one format. Then the program re-structures all
            kinds of data and puts each type, such as price, in one column, and
            it does this for over 1000 companies by combining all its financial
            data.
          </p>
        </div>
        <div class="item">
          <p>
            The data within this program is mixed data stored as pickles for
            1000+ companies' annual financial data, all combined in one table,
            which is then used further to feed a network that would learn from
            this data and can be used to predict all kinds of different outputs
            such as various financial predictions. It also calcualtes different
            required inputs, such as; Free cash flow using calculations and then
            combines data and restructures it into the same format can be used
            as direct input to Neural Networks.
          </p>
        </div>
        <div class="item">
          <p>
            To start the program just click run. This will take a while to load
            since its pulling all the data out and applying formating each time.
            This pulls annual financial data from 1000+ companies, re formats,
            restructures and organizes the data using pandas and Numpy to
            display it using JS as a table. The numbers at the top represent
            different financial information such as Revenue, Net income, Free
            cash flow, etc. From top to bottom the information is organized in
            years; each 5 rows represents 5 years of a company's financial
            information, the following 5 rows is another company's 5 years
            annual data.
          </p>
          <!-- <ul>
                        {% for i in test3 %}
                        <li>{{i}}</li>
                        {% endfor %}
                    </ul> -->

          <button type="button" id="runBtn" style="cursor: pointer">RUN</button>
          <!-- <div class="row">
                        <div class="col-md-4 offset-md-8" style="padding-bottom: 4px">
                            <select id="csvFilesFilter" class="form-control">
                                {% for file in pickle_files %}
                                <option>{{file}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                     -->
          <div
            id="lineChart"
            class="d-none"
            style="background-color: #fff; padding: 10px; border-radius: 8px"
          >
            <div class="preloader-spinner d-none"></div>

            <table id="dataTable"></table>
          </div>

          <!-- <img src="{% static 'img/results/result.png' %}" alt="Result not yet" /> -->
        </div>

        <!-- </div> -->

        <!-- <div class="portfolio-page-video embed-responsive embed-responsive-16by9">
                  <iframe class="embed-responsive-item" src="https://player.vimeo.com/video/97102654?autoplay=0"></iframe>
                </div> -->

        <script type="text/javascript">
          var myChart = false;
          jQuery(document).ready(function ($) {
            $(".portfolio-page-carousel").imagesLoaded(function () {
              $(".portfolio-page-carousel").owlCarousel({
                smartSpeed: 1200,
                items: 1,
                loop: true,
                dots: true,
                nav: true,
                navText: false,
                margin: 10,
                autoHeight: true,
              });
            });

            $("#runBtn").click(function () {
              renderChart();
            });
          });

          function renderChart() {
            $("#runBtn").attr("disabled", "disabled");
            if ($.fn.dataTable.isDataTable("#dataTable")) {
              $("#dataTable").DataTable().destroy();
              $("#dataTable").empty();
            }
            // Show loader for chart area
            $("#lineChart").removeClass("d-none");
            $(".preloader-spinner").removeClass("d-none");
            let csvFile = $("#csvFilesFilter option:selected").text();

            $.post("{% url 'data_manipulation' %}", { pickle: csvFile })
              .done(function (response) {
                $("#runBtn").removeAttr("disabled");
                console.log(response);
                let columns = [];
                response.result.columns.forEach((col) => {
                  columns.push({ title: col });
                });
                console.log(columns);
                // Hide the loader into Chart area
                $(".preloader-spinner").addClass("d-none");
                $("#dataTable").DataTable({
                  searching: false,
                  ordering: false,
                  scrollX: true,
                  columns: columns,
                  data: response.result.data,
                });
              })
              .fail(function (xhr, textStatus, errorThrown) {
                $("#runBtn").removeAttr("disabled");
                console.log(textStatus, errorThrown);
                alert(xhr.responseText);
              });
          }
        </script>
      </div>

      <div class="col-sm-4 col-md-4 portfolio-block">
        <!-- Project Description -->
        <div class="project-description">
          <div class="block-title">
            <h3>Description</h3>
          </div>
          <ul class="project-general-info">
            <li>
              <p><i class="fa fa-user"></i> Saif Alhail</p>
            </li>
            <!-- <li>
                            <p><i class="fa fa-globe"></i> <a href="#" target="_blank">www.project-site.com</a></p>
                        </li> -->
            <li>
              <p><i class="fa fa-calendar"></i> 2021</p>
            </li>
          </ul>

          <p class="text-justify">
            This Program uses stored data in pickles format; using Pandas DF
            generates tables for a significant amount of data, automatically
            reformats the data (Cleaning), and organizes the Structure.
            <br>
            All Projects created here are done only by Saif Alhail.<br> 
            All rights are reserved; Saif Alhail
          </p>
          <!-- /Project Description -->

          <!-- Technology -->
          <div class="tags-block">
            <div class="block-title">
              <h3>Technology</h3>
            </div>
            <ul class="tags">
              <li><a>Python</a></li>
              <li><a>Pandas</a></li>
              <li><a>Numpy</a></li>
              <li><a>Pickles</a></li>
              <li><a>Matplotlib</a></li>
            </ul>
          </div>
          <!-- /Technology -->

         <!-- Share Buttons -->
         <div class="btn-group share-buttons">
            <div class="block-title">
              <h3>Share</h3>
            </div>
            <a
              href="https://www.linkedin.com/in/saifalhail/"
              target="_blank"
              class="btn"
              ><i class="fab fa-linkedin"></i>
            </a>
            <!-- <a href="#" target="_blank" class="btn"><i class="fab fa-twitter"></i> </a> -->
            <!-- <a href="#" target="_blank" class="btn"><i class="fab fa-dribbble"></i> </a> -->
          </div>
          <!-- /Share Buttons -->
        </div>
        <!-- Project Description -->
      </div>
    </div>
  </div>
</div>
